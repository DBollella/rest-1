<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Rest.Api</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Rest-Api.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Rest-Api.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">rest-core-0.31: Rest API library.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Rest.Api</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Api data types.</a></li><li><a href="#g:2">Defining routes.</a></li><li><a href="#g:3">Api versioning.</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module allows you to combine <code><a href="Rest-Resource.html#t:Resource">Resource</a></code>s into an <code><a href="Rest-Api.html#t:Api">Api</a></code>. This
 can then be served using 'rest-happstack' or 'rest-snap', or used
 to generate clients or documentation using 'rest-gen'.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:Api">Api</a> m = [(<a href="Rest-Api.html#t:Version">Version</a>, <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m))]</li><li class="src short"><span class="keyword">data</span> <a href="#t:Router">Router</a> m s <span class="keyword">where</span><ul class="subs"><li><a href="#v:Embed">Embed</a> ::  <a href="Rest-Resource.html#t:Resource">Resource</a> m s sid mid aid -&gt; [<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> s)] -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Some1">Some1</a> f <span class="keyword">where</span><ul class="subs"><li><a href="#v:Some1">Some1</a> ::  f (a :: * -&gt; *) -&gt; <a href="Rest-Api.html#t:Some1">Some1</a> f</li></ul></li><li class="src short"><a href="#v:route">route</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Monad.html#t:Monad">Monad</a> s =&gt; <a href="Rest-Resource.html#t:Resource">Resource</a> m s sid mid aid -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:compose">compose</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--47-">(-/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--45--47-">(--/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--45--45--47-">(---/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--45--45--45--47-">(----/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--45--45--45--45--47-">(-----/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:-45--45--45--45--45--45--47-">(------/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</li><li class="src short"><a href="#v:root">root</a> :: (<a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Applicative.html#t:Applicative">Applicative</a> m, <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Monad.html#t:Monad">Monad</a> m) =&gt; <a href="Rest-Api.html#t:Router">Router</a> m m</li><li class="src short"><span class="keyword">data</span> <a href="#t:Version">Version</a> = <a href="#v:Version">Version</a> {<ul class="subs"><li><a href="#v:full">full</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></li><li><a href="#v:major">major</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></li><li><a href="#v:minor">minor</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></li></ul>}</li><li class="src short"><a href="#v:mkVersion">mkVersion</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="Rest-Api.html#t:Version">Version</a></li><li class="src short"><a href="#v:latest">latest</a> ::  <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Version">Version</a>, <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m))</li><li class="src short"><a href="#v:parseVersion">parseVersion</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Rest-Api.html#t:Version">Version</a></li><li class="src short"><a href="#v:lookupVersion">lookupVersion</a> ::  <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m))</li><li class="src short"><a href="#v:lookupVersion-39-">lookupVersion'</a> ::  <a href="Rest-Api.html#t:Version">Version</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m))</li><li class="src short"><a href="#v:withVersion">withVersion</a> ::  <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; r -&gt; (<a href="Rest-Api.html#t:Version">Version</a> -&gt; <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m) -&gt; r) -&gt; r</li></ul></div><div id="interface"><h1 id="g:1">Api data types.</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Api" class="def">Api</a> m = [(<a href="Rest-Api.html#t:Version">Version</a>, <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m))] <a href="src/Rest-Api.html#Api" class="link">Source</a></p><div class="doc"><p>An API is a list of versioned routers.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Router" class="def">Router</a> m s <span class="keyword">where</span> <a href="src/Rest-Api.html#Router" class="link">Source</a></p><div class="doc"><p>A <code><a href="Rest-Api.html#t:Router">Router</a></code> is a <code><a href="Rest-Resource.html#t:Resource">Resource</a></code> and a list of subresources.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Embed" class="def">Embed</a> ::  <a href="Rest-Resource.html#t:Resource">Resource</a> m s sid mid aid -&gt; [<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> s)] -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Some1" class="def">Some1</a> f <span class="keyword">where</span> <a href="src/Rest-Api.html#Some1" class="link">Source</a></p><div class="doc"><p>An existential where the second argument has kind <code>(* -&gt; *)</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Some1" class="def">Some1</a> ::  f (a :: * -&gt; *) -&gt; <a href="Rest-Api.html#t:Some1">Some1</a> f</td><td class="doc empty">&nbsp;</td></tr></table></div></div><h1 id="g:2">Defining routes.</h1><div class="top"><p class="src"><a name="v:route" class="def">route</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Monad.html#t:Monad">Monad</a> s =&gt; <a href="Rest-Resource.html#t:Resource">Resource</a> m s sid mid aid -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <a href="src/Rest-Api.html#route" class="link">Source</a></p><div class="doc"><p>Convenience constructor constructing a route without any
 subresource.</p></div></div><div class="top"><p class="src"><a name="v:compose" class="def">compose</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <a href="src/Rest-Api.html#compose" class="link">Source</a></p><div class="doc"><p>Add the second router as a subresource to the first.</p></div></div><div class="top"><p class="src"><a name="v:-45--47-" class="def">(-/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 4</span><span class="rightedge"></span> <a href="src/Rest-Api.html#-%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:-45--45--47-" class="def">(--/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 5</span><span class="rightedge"></span> <a href="src/Rest-Api.html#--%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:-45--45--45--47-" class="def">(---/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 6</span><span class="rightedge"></span> <a href="src/Rest-Api.html#---%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:-45--45--45--45--47-" class="def">(----/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 7</span><span class="rightedge"></span> <a href="src/Rest-Api.html#----%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:-45--45--45--45--45--47-" class="def">(-----/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 8</span><span class="rightedge"></span> <a href="src/Rest-Api.html#-----%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:-45--45--45--45--45--45--47-" class="def">(------/)</a> ::  <a href="Rest-Api.html#t:Router">Router</a> m s -&gt; <a href="Rest-Api.html#t:Router">Router</a> s t -&gt; <a href="Rest-Api.html#t:Router">Router</a> m s <span class="fixity">infixl 9</span><span class="rightedge"></span> <a href="src/Rest-Api.html#------%2F" class="link">Source</a></p><div class="doc"><p>Operators with the right fixities to allow you to define routes
 without using parentheses. Start with the shortest near the root.</p></div></div><div class="top"><p class="src"><a name="v:root" class="def">root</a> :: (<a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Applicative.html#t:Applicative">Applicative</a> m, <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Control-Monad.html#t:Monad">Monad</a> m) =&gt; <a href="Rest-Api.html#t:Router">Router</a> m m <a href="src/Rest-Api.html#root" class="link">Source</a></p><div class="doc"><p>An empty router to use as the root for your API.</p></div></div><h1 id="g:3">Api versioning.</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Version" class="def">Version</a> <a href="src/Rest-Api.html#Version" class="link">Source</a></p><div class="doc"><p>An API version has three parts. The first is two are used for API
 breaking changes, the last for non-API breaking changes.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Version" class="def">Version</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:full" class="def">full</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:major" class="def">major</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:minor" class="def">minor</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:Version" class="caption collapser" onclick="toggleSection('i:Version')">Instances</p><div id="section.i:Version" class="show"><table><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Eq.html#t:Eq">Eq</a> <a href="Rest-Api.html#t:Version">Version</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Ord.html#t:Ord">Ord</a> <a href="Rest-Api.html#t:Version">Version</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Text-Show.html#t:Show">Show</a> <a href="Rest-Api.html#t:Version">Version</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:mkVersion" class="def">mkVersion</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Int.html#t:Int">Int</a> -&gt; <a href="Rest-Api.html#t:Version">Version</a> <a href="src/Rest-Api.html#mkVersion" class="link">Source</a></p><div class="doc"><p>Smart constructor for <code><a href="Rest-Api.html#t:Version">Version</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:latest" class="def">latest</a> ::  <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Version">Version</a>, <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m)) <a href="src/Rest-Api.html#latest" class="link">Source</a></p><div class="doc"><p>Get the latest version of an API.</p></div></div><div class="top"><p class="src"><a name="v:parseVersion" class="def">parseVersion</a> :: <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Rest-Api.html#t:Version">Version</a> <a href="src/Rest-Api.html#parseVersion" class="link">Source</a></p><div class="doc"><p>Parse a <code><a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a></code> as a <code><a href="Rest-Api.html#t:Version">Version</a></code>. The string should contain two or
 three numbers separated by dots, e.g. <code>1.12.3</code>.</p></div></div><div class="top"><p class="src"><a name="v:lookupVersion" class="def">lookupVersion</a> ::  <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m)) <a href="src/Rest-Api.html#lookupVersion" class="link">Source</a></p><div class="doc"><p>Look up a version in an API. The string can either be a valid
 version according to <code><a href="Rest-Api.html#v:parseVersion">parseVersion</a></code>, or &quot;latest&quot;.</p></div></div><div class="top"><p class="src"><a name="v:lookupVersion-39-" class="def">lookupVersion'</a> ::  <a href="Rest-Api.html#t:Version">Version</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m)) <a href="src/Rest-Api.html#lookupVersion%27" class="link">Source</a></p><div class="doc"><p>Look up a version in the API.</p></div></div><div class="top"><p class="src"><a name="v:withVersion" class="def">withVersion</a> ::  <a href="http://hackage.haskell.org/packages/archive/base/4.7.0.0/doc/html/Data-String.html#t:String">String</a> -&gt; <a href="Rest-Api.html#t:Api">Api</a> m -&gt; r -&gt; (<a href="Rest-Api.html#t:Version">Version</a> -&gt; <a href="Rest-Api.html#t:Some1">Some1</a> (<a href="Rest-Api.html#t:Router">Router</a> m) -&gt; r) -&gt; r <a href="src/Rest-Api.html#withVersion" class="link">Source</a></p><div class="doc"><p>Given a version string, an API and a fallback, do the following:</p><ul><li>Parse the version number or &quot;latest&quot;.</li><li>Look up this version.</li><li>If ok, run the given function on it.</li><li>If not parsed or found, return the fallback.</li></ul></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.2</p></div></body></html>